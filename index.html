<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planner Yourself 2026 - FamÃ­lia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        body { font-family:'Plus Jakarta Sans',sans-serif; background:#F8FAFC; color: #1E293B; overflow-x: hidden; }
        .tab-content { display:none }
        .tab-content.active { display:block; animation:slide .25s ease-out }
        .active-nav { border-bottom:3px solid #6366f1; color:#6366f1; font-weight:800 }
        .active-sub { background:#6366f1 !important; color:white !important }
        @keyframes slide { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .active-user-btn { background: #6366f1 !important; color: white !important; box-shadow: 0 4px 6px -1px rgba(99, 102, 241, 0.4); }
        .riscado { text-decoration: line-through; opacity: 0.4; filter: grayscale(1); }
        input, select { transition: all 0.2s ease; border: 1px solid #E2E8F0; }
        input:focus, select:focus { border-color: #6366f1; ring: 2px; ring-color: #6366f1; }
    </style>
</head>
<body class="pb-10">

<section id="login-screen" class="fixed inset-0 bg-white z-[100] flex items-center justify-center p-6">
    <div class="w-full max-w-sm space-y-8">
        <div class="text-center">
            <div class="w-16 h-16 bg-indigo-600 rounded-2xl flex items-center justify-center text-white text-2xl font-black mx-auto shadow-xl">PY</div>
            <h1 class="text-2xl font-extrabold mt-4">Planner <span class="text-indigo-600">Yourself.</span></h1>
            <p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest mt-1">2026 Family Management</p>
        </div>

        <div class="flex gap-2 p-1 bg-slate-100 rounded-2xl">
            <button id="tab-entrar" onclick="toggleAuthMode('login')" class="flex-1 py-3 rounded-xl font-black text-[11px] uppercase transition-all bg-white shadow-sm">Entrar</button>
            <button id="tab-cadastrar" onclick="toggleAuthMode('cadastro')" class="flex-1 py-3 rounded-xl font-black text-[11px] uppercase transition-all text-slate-400">Cadastrar</button>
        </div>

        <div id="form-auth" class="space-y-3">
            <input id="auth-nome" type="text" placeholder="Nome da FamÃ­lia" class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none">
            <input id="auth-senha" type="password" placeholder="Senha" class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none">
            <button id="btn-auth-action" onclick="executarAuth()" class="w-full bg-indigo-600 text-white p-4 rounded-2xl font-black shadow-lg hover:scale-[1.02] active:scale-95 transition-transform">ACESSAR FAMÃLIA</button>
        </div>
    </div>
</section>

<div id="main-app" class="hidden">
    <header class="bg-white border-b sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-4 pt-4 pb-2">
            <div class="flex justify-between items-center mb-3">
                <span id="display-grupo" class="font-black text-[10px] text-indigo-600 uppercase bg-indigo-50 px-2 py-1 rounded"></span>
                <div class="flex bg-slate-100 p-1 rounded-full text-[10px] font-bold">
                    <button id="btn-user1" onclick="switchUser(db.config.user1)" class="px-4 py-1.5 rounded-full transition-all uppercase"></button>
                    <button id="btn-user2" onclick="switchUser(db.config.user2)" class="px-4 py-1.5 rounded-full transition-all uppercase"></button>
                </div>
                <button onclick="logout()" class="text-[9px] font-black text-rose-400 uppercase">Sair</button>
            </div>

            <nav class="flex gap-4 text-[10px] font-black uppercase overflow-x-auto no-scrollbar border-t mt-2">
                <button id="nav-casa" onclick="showTab('casa')" class="py-3 active-nav whitespace-nowrap">ğŸ  Tarefas</button>
                <button id="nav-agenda" onclick="showTab('agenda')" class="py-3 text-slate-400 whitespace-nowrap">ğŸ“… Agenda</button>
                <button id="nav-lazer" onclick="showTab('lazer')" class="py-3 text-slate-400 whitespace-nowrap">ğŸ· Lazer</button>
                <button id="nav-financeiro" onclick="showTab('financeiro')" class="py-3 text-slate-400 whitespace-nowrap">ğŸ’° FinanÃ§as</button>
                <button id="nav-compras" onclick="showTab('compras')" class="py-3 text-slate-400 whitespace-nowrap">ğŸ›’ Compras</button>
                <button id="nav-historico" onclick="showTab('historico')" class="py-3 text-slate-400 whitespace-nowrap">ğŸ“œ Logs</button>
                <button id="nav-perfil" onclick="showTab('perfil')" class="py-3 text-slate-400 whitespace-nowrap">ğŸ‘¤ Perfil</button>
            </nav>
        </div>
    </header>

    <main class="max-w-5xl mx-auto p-4 space-y-6">
        
        <section id="content-casa" class="tab-content active space-y-4">
            <div class="flex gap-2 overflow-x-auto pb-2 no-scrollbar" id="list-dias"></div>
            <div class="bg-white p-4 rounded-2xl border shadow-sm flex gap-2">
                <input id="novaTarefa" placeholder="O que precisa ser feito hoje?" class="flex-1 bg-transparent outline-none font-medium text-sm">
                <button onclick="addTarefa()" class="bg-indigo-600 text-white px-6 py-2 rounded-xl font-bold text-xl">+</button>
            </div>
            <div id="tarefasList" class="space-y-2"></div>
        </section>

        <section id="content-agenda" class="tab-content space-y-4">
            <div class="bg-white p-4 rounded-2xl border shadow-sm space-y-3">
                <div class="grid grid-cols-2 gap-2">
                    <input type="date" id="agendaData" class="p-3 bg-slate-50 rounded-xl font-bold text-sm outline-none">
                    <input type="time" id="agendaHora" class="p-3 bg-slate-50 rounded-xl font-bold text-sm outline-none">
                </div>
                <input type="text" id="agendaComp" placeholder="DescriÃ§Ã£o do compromisso..." class="w-full p-3 bg-slate-50 rounded-xl font-medium text-sm outline-none">
                <button onclick="addAgenda()" class="w-full bg-indigo-600 text-white p-4 rounded-xl font-black text-xs uppercase shadow-lg">Agendar Compromisso</button>
            </div>
            <div id="agendaList" class="space-y-2"></div>
        </section>

        <section id="content-lazer" class="tab-content space-y-4">
            <div class="flex gap-1 bg-slate-100 p-1 rounded-xl overflow-x-auto no-scrollbar" id="lazer-tabs"></div>
            <div id="lazer-main-area">
                <div id="lazer-controls">
                    <button onclick="sortearLazer()" class="w-full bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white p-5 rounded-2xl font-black shadow-lg text-xs uppercase flex items-center justify-center gap-2 mb-4">
                        <span>ğŸ°</span> <span id="btn-sorteio-texto">Sortear Destino</span>
                    </button>
                    <div class="bg-white p-4 rounded-2xl border flex gap-2 mb-4">
                        <input id="lazerNome" placeholder="Nome do local..." class="flex-1 text-sm font-medium outline-none">
                        <button onclick="addLazer()" class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold">+</button>
                    </div>
                </div>
                <div id="lazerList" class="space-y-2"></div>
            </div>
        </section>

        <section id="content-financeiro" class="tab-content space-y-4">
            <div class="grid grid-cols-2 gap-3 text-center">
                <div class="bg-slate-900 p-4 rounded-3xl text-white">
                    <p class="text-[8px] font-black opacity-60 uppercase">Saldo SalÃ¡rio</p>
                    <p id="fin-salario" class="text-lg font-black mt-1">R$ 0,00</p>
                </div>
                <div class="bg-emerald-600 p-4 rounded-3xl text-white">
                    <p class="text-[8px] font-black opacity-60 uppercase">Saldo VR/VA</p>
                    <p id="fin-vrava" class="text-lg font-black mt-1">R$ 0,00</p>
                </div>
            </div>
            <div class="bg-white p-5 rounded-3xl border space-y-3">
                <input id="finValor" type="number" placeholder="Valor R$" class="w-full p-4 bg-slate-50 rounded-2xl font-bold outline-none text-lg">
                <select id="finTipo" class="w-full p-4 bg-slate-50 rounded-2xl text-xs font-black uppercase outline-none cursor-pointer">
                    <optgroup label="ENTRADAS">
                        <option value="rec_salario">â• Receber SalÃ¡rio (Manu/Pedro)</option>
                        <option value="rec_vrava">â• CrÃ©dito VR/VA</option>
                    </optgroup>
                    <optgroup label="SAÃDAS (DINHEIRO)">
                        <option value="fix_conta">ğŸŒ Custos Fixos (Internet/Luz/etc)</option>
                        <option value="fix_lazer">ğŸ’³ CrÃ©dito/Academia/Outros</option>
                    </optgroup>
                    <optgroup label="SAÃDAS (ALIMENTAÃ‡ÃƒO)">
                        <option value="gas_restaurante">ğŸ½ï¸ Restaurante / Delivery</option>
                        <option value="gas_vrava">ğŸ›’ Compra do MÃªs</option>
                    </optgroup>
                </select>
                <input id="finJustificativa" placeholder="Justificativa (obrigatÃ³rio para 'Outros')" class="w-full p-3 bg-slate-50 rounded-xl text-sm outline-none">
                <button onclick="addFinanceiro()" class="w-full bg-indigo-600 text-white p-4 rounded-2xl font-black text-xs uppercase shadow-xl hover:bg-indigo-700 transition-colors">Registrar TransaÃ§Ã£o</button>
            </div>
            <div id="financeiroHistorico" class="space-y-2"></div>
        </section>

        <section id="content-compras" class="tab-content space-y-4">
            <div class="grid grid-cols-2 gap-2">
                <button onclick="restaurarCompras()" class="bg-indigo-50 text-indigo-600 py-3 rounded-xl font-black text-[10px] uppercase border border-indigo-100">Restaurar Oficial</button>
                <button onclick="limparComprasTicadas()" class="bg-rose-50 text-rose-600 py-3 rounded-xl font-black text-[10px] uppercase border border-rose-100">Limpar Comprados</button>
            </div>
            <div class="bg-white p-4 rounded-2xl border flex gap-2">
                <input id="compraNovoItem" placeholder="Adicionar item extra..." class="flex-1 text-sm font-medium outline-none">
                <button onclick="addCompraManual()" class="bg-indigo-600 text-white px-4 py-2 rounded-xl font-bold">+</button>
            </div>
            <div id="comprasList" class="space-y-4"></div>
        </section>

        <section id="content-historico" class="tab-content space-y-4">
            <div class="flex justify-between items-center px-1">
                <h3 class="text-[10px] font-black uppercase text-slate-400">Linha do Tempo</h3>
                <span class="text-[9px] font-bold text-indigo-500">Apenas Leitura</span>
            </div>
            <div id="historicoContainer" class="space-y-2"></div>
        </section>

        <section id="content-perfil" class="tab-content space-y-4">
            <div class="bg-white p-6 rounded-3xl border space-y-4 text-center">
                <p class="text-[10px] font-black text-slate-400 uppercase">ConfiguraÃ§Ã£o da FamÃ­lia</p>
                <div class="space-y-2">
                    <label class="text-[9px] font-bold text-left block ml-2 text-slate-400">USUÃRIO 1</label>
                    <input id="input-user1" class="w-full p-4 bg-slate-50 rounded-2xl font-bold text-center outline-indigo-500">
                </div>
                <div class="space-y-2">
                    <label class="text-[9px] font-bold text-left block ml-2 text-slate-400">USUÃRIO 2</label>
                    <input id="input-user2" class="w-full p-4 bg-slate-50 rounded-2xl font-bold text-center outline-indigo-500">
                </div>
                <button onclick="saveUsers()" class="w-full bg-indigo-600 text-white p-4 rounded-2xl font-black text-xs uppercase shadow-xl">Atualizar Nomes</button>
            </div>
        </section>
    </main>
</div>

<div id="modal-sorteio" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[200] flex items-center justify-center p-6">
    <div class="bg-white w-full max-w-xs rounded-[40px] p-10 text-center space-y-4 shadow-2xl transition-all border border-indigo-100">
        <div class="text-5xl animate-bounce">ğŸ°</div>
        <h2 class="text-[10px] font-black uppercase text-slate-400 tracking-widest">O sorteado foi</h2>
        <div id="sorteio-roleta" class="text-3xl font-black text-indigo-600 py-4 flex items-center justify-center min-h-[80px]">
            <span id="nome-sorteado">...</span>
        </div>
        <button onclick="fecharModalSorteio()" class="w-full bg-indigo-600 text-white p-4 rounded-2xl font-black text-xs uppercase tracking-widest shadow-lg">BORAAAA!</button>
    </div>
</div>

<script>
// --- CONFIG FIREBASE ---
const firebaseConfig = {
    apiKey: "AIzaSyALUTZ-W5KWoSXw5DoJ3AbeMNzFsvTurNo",
    authDomain: "home-2-f8b01.firebaseapp.com",
    databaseURL: "https://home-2-f8b01-default-rtdb.firebaseio.com",
    projectId: "home-2-f8b01"
};
firebase.initializeApp(firebaseConfig);

// --- ESTADO GLOBAL ---
let currentGroup = localStorage.getItem('py_group_2026_vFinal');
let currentUser = "";
let authMode = "login";
const dias = ["Domingo", "Segunda", "TerÃ§a", "Quarta", "Quinta", "Sexta", "SÃ¡bado"];
let currentDay = dias[new Date().getDay()]; 
let currentLazerCat = "CafÃ©s";

const defaultDB = {
    config: { user1: "Manu", user2: "Pedro" },
    tarefas: { "Segunda": [], "TerÃ§a": [], "Quarta": [], "Quinta": [], "Sexta": [], "SÃ¡bado": [], "Domingo": [] },
    financeiro: { salario: 0, vrava: 0, historico: [] },
    lazer: [],
    compras: [],
    agenda: [],
    logs: [],
    senha: ""
};
let db = { ...defaultDB };

// --- LOGIN / CADASTRO SEPARADOS ---
function toggleAuthMode(mode) {
    authMode = mode;
    const btn = document.getElementById('btn-auth-action');
    const tabEntrar = document.getElementById('tab-entrar');
    const tabCadastrar = document.getElementById('tab-cadastrar');

    if(mode === 'login') {
        btn.innerText = "ACESSAR FAMÃLIA";
        tabEntrar.className = "flex-1 py-3 rounded-xl font-black text-[11px] uppercase transition-all bg-white shadow-sm";
        tabCadastrar.className = "flex-1 py-3 rounded-xl font-black text-[11px] uppercase transition-all text-slate-400";
    } else {
        btn.innerText = "CRIAR NOVA FAMÃLIA";
        tabCadastrar.className = "flex-1 py-3 rounded-xl font-black text-[11px] uppercase transition-all bg-white shadow-sm";
        tabEntrar.className = "flex-1 py-3 rounded-xl font-black text-[11px] uppercase transition-all text-slate-400";
    }
}

function executarAuth() {
    const g = document.getElementById('auth-nome').value.trim().toLowerCase();
    const s = document.getElementById('auth-senha').value.trim();
    if(!g || !s) return alert("Preencha os campos!");

    if(authMode === 'cadastro') {
        firebase.database().ref('v2026_final/' + g).once('value', snap => {
            if(snap.exists()) return alert("FamÃ­lia jÃ¡ cadastrada!");
            firebase.database().ref('v2026_final/' + g).set({...defaultDB, senha: s}).then(() => logar(g));
        });
    } else {
        firebase.database().ref('v2026_final/' + g).once('value', snap => {
            const d = snap.val();
            if(d && d.senha === s) logar(g); else alert("Nome ou Senha incorretos!");
        });
    }
}

function logar(g) {
    currentGroup = g;
    localStorage.setItem('py_group_2026_vFinal', g);
    document.getElementById('login-screen').classList.add('hidden');
    document.getElementById('main-app').classList.remove('hidden');
    document.getElementById('display-grupo').innerText = "@" + g.toUpperCase();
    firebase.database().ref('v2026_final/' + g).on('value', snap => {
        if(snap.exists()) { db = snap.val(); if(!currentUser) currentUser = db.config.user1; render(); }
    });
}

function logout() { localStorage.removeItem('py_group_2026_vFinal'); location.reload(); }
function save() { if(currentGroup) firebase.database().ref('v2026_final/' + currentGroup).update(db); }

function registrarLog(msg) {
    if(!db.logs) db.logs = [];
    db.logs.unshift({ u: currentUser, date: new Date().toLocaleString('pt-BR'), msg });
}

// --- TAREFAS ---
function addTarefa() {
    const t = document.getElementById('novaTarefa').value; if(!t) return;
    if(!db.tarefas[currentDay]) db.tarefas[currentDay] = [];
    db.tarefas[currentDay].push({ id: Date.now(), txt: t, u: currentUser });
    registrarLog(`Tarefa: ${t} (${currentDay})`);
    document.getElementById('novaTarefa').value = ""; save();
}
function removerTarefa(id, dia) {
    db.tarefas[dia] = db.tarefas[dia].filter(x => x.id !== id);
    save();
}

// --- AGENDA ---
function addAgenda() {
    const d = document.getElementById('agendaData').value;
    const h = document.getElementById('agendaHora').value;
    const c = document.getElementById('agendaComp').value;
    if(!d || !c) return alert("Defina data e descriÃ§Ã£o!");
    if(!db.agenda) db.agenda = [];
    db.agenda.push({ id: Date.now(), data: d, hora: h, txt: c, u: currentUser });
    registrarLog(`Agenda: ${c} p/ ${d}`);
    document.getElementById('agendaComp').value = ""; save();
}
function removerAgenda(id) {
    db.agenda = db.agenda.filter(x => x.id !== id);
    save();
}

// --- FINANCEIRO ---
function addFinanceiro() {
    const v = Number(document.getElementById('finValor').value);
    const tipo = document.getElementById('finTipo').value;
    const just = document.getElementById('finJustificativa').value;
    if(!v) return;

    if(!db.financeiro.historico) db.financeiro.historico = [];
    
    if(tipo === 'rec_salario') db.financeiro.salario += v;
    else if(tipo === 'rec_vrava') db.financeiro.vrava += v;
    else if(tipo.startsWith('fix_')) db.financeiro.salario -= v;
    else if(tipo.startsWith('gas_')) db.financeiro.vrava -= v;

    db.financeiro.historico.unshift({ id: Date.now(), v, tipo, u: currentUser, just: just || "" });
    registrarLog(`Financeiro: ${tipo} R$ ${v}`);
    document.getElementById('finValor').value = ""; document.getElementById('finJustificativa').value = ""; save();
}
function removerFinanceiro(id) {
    const item = db.financeiro.historico.find(x => x.id === id);
    if(item) {
        if(item.tipo === 'rec_salario') db.financeiro.salario -= item.v;
        else if(item.tipo === 'rec_vrava') db.financeiro.vrava -= item.v;
        else if(item.tipo.startsWith('fix_')) db.financeiro.salario += item.v;
        else if(item.tipo.startsWith('gas_')) db.financeiro.vrava += item.v;
        db.financeiro.historico = db.financeiro.historico.filter(x => x.id !== id);
        save();
    }
}

// --- LAZER ---
function addLazer() {
    const n = document.getElementById('lazerNome').value; if(!n) return;
    if(!db.lazer) db.lazer = [];
    db.lazer.push({ id: Date.now(), n, cat: currentLazerCat });
    registrarLog(`Lazer: Adicionou ${n} em ${currentLazerCat}`);
    document.getElementById('lazerNome').value = ""; save();
}
function removerLazer(id) {
    db.lazer = db.lazer.filter(x => x.id !== id);
    save();
}
function sortearLazer() {
    const f = (db.lazer || []).filter(x => x.cat === currentLazerCat);
    if(f.length < 2) return alert("Cadastre pelo menos 2 locais nesta categoria!");
    const m = document.getElementById('modal-sorteio');
    const d = document.getElementById('nome-sorteado');
    m.classList.remove('hidden');
    let g = 0;
    const i = setInterval(() => {
        d.innerText = f[Math.floor(Math.random()*f.length)].n;
        if(++g >= 15) { 
            clearInterval(i); 
            const v = f[Math.floor(Math.random()*f.length)].n; 
            d.innerText = v; 
            registrarLog(`ğŸ° SORTEIO: ${v} selecionado em ${currentLazerCat}`); 
        }
    }, 100);
}
function fecharModalSorteio() { document.getElementById('modal-sorteio').classList.add('hidden'); }

// --- COMPRAS ---
function addCompraManual() {
    const v = document.getElementById('compraNovoItem').value; if(!v) return;
    if(!db.compras) db.compras = [];
    db.compras.push({ id: Date.now(), cat: "ğŸ›’ EXTRAS", val: v, check: false });
    document.getElementById('compraNovoItem').value = ""; save();
}
function toggleCompra(id) {
    const i = db.compras.findIndex(x => x.id === id);
    db.compras[i].check = !db.compras[i].check;
    save();
}
function restaurarCompras() {
    const listaFinal = [
        {c:"ğŸ¥© PROTEÃNAS", v:"Carne moÃ­da / Peito de frango"},
        {c:"ğŸ CARBOIDRATOS", v:"Arroz / FeijÃ£o / MacarrÃ£o"},
        {c:"ğŸ¥› LATICÃNIOS", v:"Leite / Mussarela / Iogurte"},
        {c:"ğŸ§¼ HIGIENE", v:"Papel HigiÃªnico / Sabonete"},
        {c:"ğŸ¥• HORTIFRUTI", v:"Batata / Cebola / Frutas"}
    ];
    db.compras = listaFinal.map(i => ({ id: Math.random(), cat: i.c, val: i.v, check: false }));
    registrarLog("Restaurou lista oficial de compras");
    save();
}
function limparComprasTicadas() { db.compras = (db.compras || []).filter(x => !x.check); save(); }
function removerCompra(id) { db.compras = db.compras.filter(x => x.id !== id); save(); }

// --- PERFIL ---
function saveUsers() {
    db.config.user1 = document.getElementById('input-user1').value;
    db.config.user2 = document.getElementById('input-user2').value;
    registrarLog("Alterou nomes dos integrantes");
    save(); alert("Nomes atualizados!");
}
function switchUser(u) { currentUser = u; render(); }
function showTab(id) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.getElementById('content-'+id).classList.add('active');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-nav', 'text-slate-400'));
    document.getElementById('nav-'+id).classList.add('active-nav');
}

// --- RENDERIZADOR ---
function render() {
    document.getElementById('btn-user1').innerText = db.config.user1;
    document.getElementById('btn-user2').innerText = db.config.user2;
    document.getElementById('btn-user1').className = currentUser === db.config.user1 ? "px-4 py-1.5 rounded-full active-user-btn" : "px-4 py-1.5 rounded-full text-slate-400";
    document.getElementById('btn-user2').className = currentUser === db.config.user2 ? "px-4 py-1.5 rounded-full active-user-btn" : "px-4 py-1.5 rounded-full text-slate-400";
    document.getElementById('input-user1').value = db.config.user1;
    document.getElementById('input-user2').value = db.config.user2;

    // Render Tarefas
    const diasNav = ["Segunda", "TerÃ§a", "Quarta", "Quinta", "Sexta", "SÃ¡bado", "Domingo"];
    document.getElementById('list-dias').innerHTML = diasNav.map(d => `<button onclick="currentDay='${d}';render()" class="px-5 py-2 rounded-2xl text-[10px] font-black uppercase transition-all ${currentDay===d?'bg-indigo-600 text-white shadow-lg':'bg-white text-slate-400 border'}">${d}</button>`).join("");
    document.getElementById('tarefasList').innerHTML = (db.tarefas[currentDay] || []).map(t => `<div class="bg-white p-4 rounded-2xl border flex justify-between items-center shadow-sm"><span class="text-sm font-bold text-slate-700">${t.txt}</span><button onclick="removerTarefa(${t.id},'${currentDay}')" class="text-rose-400 p-2">âœ•</button></div>`).join("");

    // Render Agenda
    document.getElementById('agendaList').innerHTML = (db.agenda || []).sort((a,b)=>new Date(a.data)-new Date(b.data)).map(a => `<div class="bg-white p-4 rounded-2xl border flex justify-between items-center shadow-sm"><div><p class="text-[9px] font-black text-indigo-500 uppercase">${a.data.split('-').reverse().join('/')} ${a.hora||''}</p><p class="text-sm font-bold">${a.txt}</p><p class="text-[8px] text-slate-400 uppercase font-black">por ${a.u}</p></div><button onclick="removerAgenda(${a.id})" class="text-rose-400">âœ•</button></div>`).join("");

    // Render Financeiro
    document.getElementById('fin-salario').innerText = (db.financeiro.salario || 0).toLocaleString('pt-br',{style:'currency',currency:'BRL'});
    document.getElementById('fin-vrava').innerText = (db.financeiro.vrava || 0).toLocaleString('pt-br',{style:'currency',currency:'BRL'});
    document.getElementById('financeiroHistorico').innerHTML = (db.financeiro.historico || []).slice(0,15).map(h => `<div class="bg-white p-3 rounded-xl border flex justify-between items-center text-[10px]"><div class="flex flex-col"><span class="font-black uppercase text-indigo-600">${h.tipo}</span><span class="text-slate-400">${h.u} ${h.just?' - '+h.just:''}</span></div><div class="flex items-center gap-3"><span class="font-black text-slate-700">R$ ${h.v.toFixed(2)}</span><button onclick="removerFinanceiro(${h.id})" class="text-rose-300">âœ•</button></div></div>`).join("");

    // Render Lazer
    const lcat = ["CafÃ©s", "Restaurante", "Bar", "Pizzarias", "Cinemas", "Logs"];
    document.getElementById('lazer-tabs').innerHTML = lcat.map(c => `<button onclick="currentLazerCat='${c}';render()" class="flex-1 py-2 px-3 text-[9px] font-black rounded-lg transition-all ${currentLazerCat===c?'active-sub':'text-slate-500'} uppercase whitespace-nowrap">${c}</button>`).join("");
    const lList = document.getElementById('lazerList');
    if(currentLazerCat === "Logs") {
        document.getElementById('lazer-controls').classList.add('hidden');
        lList.innerHTML = (db.logs || []).filter(l => l.msg.includes("ğŸ°")).map(l => `<div class="bg-indigo-50 p-2 rounded-lg text-[9px] font-bold border border-indigo-100 mb-1">${l.date}: ${l.msg}</div>`).join("");
    } else {
        document.getElementById('lazer-controls').classList.remove('hidden');
        document.getElementById('btn-sorteio-texto').innerText = `Sortear em ${currentLazerCat}`;
        lList.innerHTML = (db.lazer || []).filter(x => x.cat === currentLazerCat).map(l => `<div class="bg-white p-4 rounded-2xl border flex justify-between items-center shadow-sm"><span class="text-sm font-bold text-slate-700">${l.n}</span><button onclick="removerLazer(${l.id})" class="text-rose-400">âœ•</button></div>`).join("");
    }

    // Render Compras
    let cH = "";
    const catsCompras = [...new Set((db.compras || []).map(x => x.cat))];
    catsCompras.forEach(cat => {
        cH += `<p class="text-[9px] font-black text-slate-400 uppercase mt-4 mb-2 ml-1 tracking-widest">${cat}</p>`;
        (db.compras || []).filter(x => x.cat === cat).forEach(i => {
            cH += `<div class="bg-white p-4 rounded-2xl border flex justify-between items-center mb-2 shadow-sm"><div onclick="toggleCompra(${i.id})" class="flex items-center gap-3 cursor-pointer"><div class="w-6 h-6 border-2 rounded-lg ${i.check?'bg-emerald-500 border-emerald-500':'border-slate-200'} flex items-center justify-center">${i.check?'<span class="text-white">âœ“</span>':''}</div><span class="text-sm font-bold ${i.check?'riscado':''} text-slate-700">${i.val}</span></div><button onclick="removerCompra(${i.id})" class="text-rose-400 p-1">âœ•</button></div>`;
        });
    });
    document.getElementById('comprasList').innerHTML = cH || "<p class='text-center opacity-30 py-10 text-xs font-bold'>A lista estÃ¡ vazia</p>";

    // Render Logs Gerais
    document.getElementById('historicoContainer').innerHTML = (db.logs || []).slice(0,40).map(l => `<div class="bg-white p-3 rounded-xl border text-[10px] shadow-sm"><div class="flex justify-between items-start mb-1"><span class="font-black text-indigo-600 uppercase tracking-tighter">${l.u}</span><span class="text-slate-300 text-[8px]">${l.date}</span></div><p class="font-bold text-slate-700 leading-tight">${l.msg}</p></div>`).join("");
}

// InicializaÃ§Ã£o
if(currentGroup) logar(currentGroup);
</script>
</body>
</html>
