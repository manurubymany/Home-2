<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Organizador Pessoal PRO</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<style>
    body { font-family:'Plus Jakarta Sans',sans-serif; background:#F8FAFC; }
    .tab-content, .subtab-content { display:none }
    .tab-content.active, .subtab-content.active { display:block; animation:slide .25s ease }
    .active-nav { border-bottom:3px solid #6366f1; color:#6366f1; font-weight:800 }
    .active-sub { background:#6366f1 !important; color:white !important }
    @keyframes slide { from{opacity:0;transform:translateY(8px)} to{opacity:1} }
</style>
</head>
<body>

<header class="bg-white border-b sticky top-0 z-50 shadow-sm">
  <div class="max-w-5xl mx-auto px-4 h-16 flex justify-between items-center">
    <div class="flex items-center gap-2">
      <div class="w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center text-white font-bold">O</div>
      <span class="font-bold text-lg">Organizador<span class="text-indigo-600">.</span></span>
    </div>
    <div class="flex bg-slate-100 p-1 rounded-full text-xs font-semibold">
      <button id="btn-Manu" onclick="switchUser('Manu')" class="px-4 py-1.5 rounded-full bg-white shadow text-indigo-600">Manu: <span id="score-Manu">0</span>pts</button>
      <button id="btn-Pedro" onclick="switchUser('Pedro')" class="px-4 py-1.5 rounded-full text-slate-500">Pedro: <span id="score-Pedro">0</span>pts</button>
    </div>
  </div>
  <nav class="max-w-5xl mx-auto px-4 flex gap-4 text-[10px] font-black uppercase overflow-x-auto">
    <button id="nav-casa" onclick="showTab('casa')" class="py-3 active-nav">ğŸ  Tarefas</button>
    <button id="nav-lazer" onclick="showTab('lazer')" class="py-3 text-slate-400">ğŸ· Lazer</button>
    <button id="nav-financeiro" onclick="showTab('financeiro')" class="py-3 text-slate-400">ğŸ’° Financeiro</button>
    <button id="nav-compras" onclick="showTab('compras')" class="py-3 text-slate-400">ğŸ›’ Compras</button>
    <button id="nav-agenda" onclick="showTab('agenda')" class="py-3 text-slate-400">ğŸ“… Agenda</button>
    <button id="nav-historico" onclick="showTab('historico')" class="py-3 text-slate-400">ğŸ“œ HistÃ³rico</button>
  </nav>
</header>

<main class="max-w-5xl mx-auto p-4 space-y-8">

<section id="content-casa" class="tab-content active space-y-4">
  <h2 class="text-xl font-bold">Tarefas de <span id="view-name">Manu</span></h2>
  <div class="flex gap-2 overflow-x-auto pb-2" id="list-dias"></div>
  <div class="bg-white p-4 rounded-xl border space-y-2">
    <input id="novaTarefa" placeholder="Nova tarefa" class="w-full p-2 bg-slate-100 rounded">
    <select id="tarefaUser" class="w-full p-2 bg-slate-100 rounded">
      <option value="Manu">Manu</option>
      <option value="Pedro">Pedro</option>
    </select>
    <button onclick="addTarefa()" class="w-full bg-indigo-600 text-white p-2 rounded">Cadastrar tarefa</button>
  </div>
  <div id="tarefasList" class="space-y-2"></div>
</section>

<section id="content-lazer" class="tab-content space-y-4">
  <div class="flex justify-between items-center">
    <h2 class="text-xl font-bold">Lazer</h2>
    <button onclick="sortearLazer()" class="bg-amber-500 text-white px-4 py-2 rounded-lg text-sm font-bold">ğŸ° Sortear Local</button>
  </div>

  <div class="flex gap-2 overflow-x-auto bg-slate-100 p-1 rounded-lg">
    <button onclick="switchLazerCat('Bares')" id="btn-cat-Bares" class="lazer-cat-btn flex-1 py-2 text-[10px] font-bold rounded active-sub">BARES</button>
    <button onclick="switchLazerCat('CafÃ©s')" id="btn-cat-CafÃ©s" class="lazer-cat-btn flex-1 py-2 text-[10px] font-bold rounded">CAFÃ‰S</button>
    <button onclick="switchLazerCat('Restaurantes')" id="btn-cat-Restaurantes" class="lazer-cat-btn flex-1 py-2 text-[10px] font-bold rounded">RESTAURANTES</button>
    <button onclick="switchLazerCat('Cinemas')" id="btn-cat-Cinemas" class="lazer-cat-btn flex-1 py-2 text-[10px] font-bold rounded">CINEMAS</button>
  </div>

  <div class="bg-white p-4 rounded-xl border space-y-2">
    <input id="lazerNome" placeholder="Lugar/Atividade" class="w-full p-2 bg-slate-100 rounded">
    <input id="lazerValor" type="number" placeholder="Custo estimado" class="w-full p-2 bg-slate-100 rounded">
    <button onclick="addLazer()" class="w-full bg-indigo-600 text-white p-2 rounded">Adicionar Ã  Lista (<span id="active-cat-label">Bares</span>)</button>
  </div>
  <div id="lazerList" class="space-y-2"></div>
</section>

<section id="content-financeiro" class="tab-content space-y-4">
  <div class="grid grid-cols-2 gap-4">
    <div class="bg-indigo-600 text-white p-6 rounded-2xl"><p>Saldo Lazer</p><p class="text-2xl font-black" id="fin-lazer">R$ 0,00</p></div>
    <div class="bg-emerald-500 text-white p-6 rounded-2xl"><p>Saldo Geral</p><p class="text-2xl font-black" id="fin-casa">R$ 0,00</p></div>
  </div>
  <div class="bg-white p-4 rounded-xl border space-y-2">
    <input id="finValor" type="number" placeholder="Valor R$" class="w-full p-2 bg-slate-100 rounded">
    <input id="finJust" type="text" placeholder="Justificativa" class="w-full p-2 bg-slate-100 rounded">
    <select id="finDestino" class="w-full p-2 bg-slate-100 rounded">
        <option value="lazer">Lazer</option>
        <option value="casa">Geral</option>
    </select>
    <div class="flex gap-2">
        <button onclick="addFinanceiro(1)" class="flex-1 bg-emerald-600 text-white p-2 rounded">Entrada (+)</button>
        <button onclick="addFinanceiro(-1)" class="flex-1 bg-rose-600 text-white p-2 rounded">Baixa (-)</button>
    </div>
  </div>
</section>

<section id="content-compras" class="tab-content space-y-4">
  <h2 class="text-xl font-bold">Lista de Compras</h2>
  <div class="bg-white p-4 rounded-xl border space-y-2">
    <input id="compraItem" placeholder="Produto" class="w-full p-2 bg-slate-100 rounded">
    <button onclick="addCompra()" class="w-full bg-indigo-600 text-white p-2 rounded">Cadastrar</button>
  </div>
  <div id="comprasList" class="bg-white rounded-xl border divide-y"></div>
</section>

<section id="content-agenda" class="tab-content space-y-4">
  <h2 class="text-xl font-bold" id="calendar-title">CalendÃ¡rio</h2>
  <div id="calendar" class="bg-white p-4 rounded-xl border">
      <div class="grid grid-cols-7 text-center text-[10px] font-bold pb-2 border-b mb-2">
          <span class="text-rose-500">DOM</span><span>SEG</span><span>TER</span><span>QUA</span><span>QUI</span><span>SEX</span><span>SÃB</span>
      </div>
      <div id="calendar-grid" class="grid grid-cols-7 gap-1"></div>
  </div>
  <div class="bg-white p-4 rounded-xl border space-y-2">
      <input id="ageData" type="date" class="w-full p-2 bg-slate-100 rounded">
      <input id="ageDesc" placeholder="Evento" class="w-full p-2 bg-slate-100 rounded">
      <button onclick="addAgenda()" class="w-full bg-indigo-600 text-white p-2 rounded">Agendar</button>
  </div>
</section>

<section id="content-historico" class="tab-content space-y-4">
    <div class="flex gap-2 overflow-x-auto bg-slate-100 p-1 rounded-lg">
        <button onclick="showSubTab('h-tarefas')" class="sub-btn flex-1 py-2 text-[10px] font-bold rounded active-sub">TAREFAS</button>
        <button onclick="showSubTab('h-lazer')" class="sub-btn flex-1 py-2 text-[10px] font-bold rounded">LAZER</button>
        <button onclick="showSubTab('h-compras')" class="sub-btn flex-1 py-2 text-[10px] font-bold rounded">COMPRAS</button>
        <button onclick="showSubTab('h-fin')" class="sub-btn flex-1 py-2 text-[10px] font-bold rounded">FINANCEIRO</button>
    </div>
    <div id="h-tarefas" class="subtab-content active space-y-2"></div>
    <div id="h-lazer" class="subtab-content space-y-2"></div>
    <div id="h-compras" class="subtab-content space-y-2"></div>
    <div id="h-fin" class="subtab-content space-y-2"></div>
</section>

</main>

<script>
let currentUser = "Manu";
let currentDay = "Segunda";
let currentLazerCat = "Bares";

let db = JSON.parse(localStorage.getItem('org_db')) || {
    scores: { Manu: 0, Pedro: 0 },
    tarefas: { "Segunda":[], "TerÃ§a":[], "Quarta":[], "Quinta":[], "Sexta":[], "SÃ¡bado":[], "Domingo":[] },
    lazer: [],
    financeiro: { lazer: 0, casa: 0 },
    compras: [],
    agenda: [],
    historico: { tarefas: [], lazer: [], compras: [], fin: [] }
};

function save() { localStorage.setItem('org_db', JSON.stringify(db)); render(); }

function showTab(id) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.getElementById('content-'+id).classList.add('active');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active-nav'));
    document.getElementById('nav-'+id).classList.add('active-nav');
}

function showSubTab(id) {
    document.querySelectorAll('.subtab-content').forEach(t => t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    document.querySelectorAll('.sub-btn').forEach(b => b.classList.remove('active-sub'));
    event.target.classList.add('active-sub');
}

function switchUser(u) {
    currentUser = u;
    document.getElementById('view-name').innerText = u;
    render();
}

function switchLazerCat(cat) {
    currentLazerCat = cat;
    render();
}

// TAREFAS
function addTarefa() {
    const t = document.getElementById('novaTarefa').value;
    const u = document.getElementById('tarefaUser').value;
    if(!t) return;
    db.tarefas[currentDay].push({id: Date.now(), t, u, done: false});
    document.getElementById('novaTarefa').value = "";
    save();
}

function concluirTarefa(id, dia) {
    const idx = db.tarefas[dia].findIndex(x => x.id === id);
    const item = db.tarefas[dia][idx];
    db.scores[item.u] += 10;
    db.historico.tarefas.push({...item, date: new Date().toLocaleDateString()});
    db.tarefas[dia].splice(idx, 1);
    save();
}

function excluirTarefa(id, dia) {
    const idx = db.tarefas[dia].findIndex(x => x.id === id);
    db.tarefas[dia].splice(idx, 1);
    save();
}

// COMPRAS
function addCompra() {
    const val = document.getElementById('compraItem').value;
    if(!val) return;
    db.compras.push({id: Date.now(), val});
    document.getElementById('compraItem').value = "";
    save();
}

function ticarCompra(id) {
    const idx = db.compras.findIndex(x => x.id === id);
    db.historico.compras.push({...db.compras[idx], date: new Date().toLocaleDateString()});
    db.compras.splice(idx, 1);
    save();
}

// FINANCEIRO
function addFinanceiro(mult) {
    const v = Number(document.getElementById('finValor').value) * mult;
    const j = document.getElementById('finJust').value;
    const d = document.getElementById('finDestino').value;
    if(!v || !j) return;
    db.financeiro[d] += v;
    db.historico.fin.push({v, j, d, date: new Date().toLocaleDateString()});
    document.getElementById('finValor').value = "";
    document.getElementById('finJust').value = "";
    save();
}

// LAZER
function addLazer() {
    const n = document.getElementById('lazerNome').value;
    const v = document.getElementById('lazerValor').value;
    if(!n) return;
    db.lazer.push({n, v, cat: currentLazerCat, id: Date.now()});
    document.getElementById('lazerNome').value = "";
    document.getElementById('lazerValor').value = "";
    save();
}

function sortearLazer() {
    const listaCat = db.lazer.filter(l => l.cat === currentLazerCat);
    if(listaCat.length === 0) return alert("Adicione locais nesta categoria primeiro!");
    const sorteado = listaCat[Math.floor(Math.random() * listaCat.length)];
    alert(`ğŸ° SORTEADO (${currentLazerCat.toUpperCase()}): ${sorteado.n}`);
    db.historico.lazer.push({...sorteado, date: new Date().toLocaleDateString()});
    save();
}

// AGENDA
function addAgenda() {
    const d = document.getElementById('ageData').value;
    const desc = document.getElementById('ageDesc').value;
    if(!d || !desc) return;
    db.agenda.push({d, desc, u: currentUser});
    save();
}

function render() {
    document.getElementById('score-Manu').innerText = db.scores.Manu;
    document.getElementById('score-Pedro').innerText = db.scores.Pedro;
    
    // Render Dias Tarefas
    document.getElementById('list-dias').innerHTML = Object.keys(db.tarefas).map(d => 
        `<button onclick="currentDay='${d}';render()" class="px-3 py-1 rounded-full text-[10px] font-bold ${currentDay===d?'bg-indigo-600 text-white':'bg-slate-200'}">${d.slice(0,3)}</button>`
    ).join("");

    document.getElementById('tarefasList').innerHTML = db.tarefas[currentDay].map(t => `
        <div class="bg-white p-3 rounded-lg border flex justify-between items-center ${t.u !== currentUser ? 'opacity-40' : ''}">
            <span><small class="block text-[8px] font-bold text-indigo-500">${t.u}</small>${t.t}</span>
            <div class="flex gap-2">
                <button onclick="concluirTarefa(${t.id}, '${currentDay}')" class="w-8 h-8 bg-emerald-100 text-emerald-600 rounded-lg flex items-center justify-center font-bold">âœ“</button>
                <button onclick="excluirTarefa(${t.id}, '${currentDay}')" class="w-8 h-8 bg-rose-100 text-rose-600 rounded-lg flex items-center justify-center font-bold">âœ•</button>
            </div>
        </div>`).join("");

    // Render Lazer
    document.querySelectorAll('.lazer-cat-btn').forEach(b => b.classList.remove('active-sub'));
    document.getElementById('btn-cat-' + currentLazerCat).classList.add('active-sub');
    document.getElementById('active-cat-label').innerText = currentLazerCat;
    document.getElementById('lazerList').innerHTML = db.lazer.filter(l => l.cat === currentLazerCat).map(l => `
        <div class="bg-white p-3 rounded border flex justify-between items-center text-sm">
            <span><b>${l.n}</b> <small class="text-slate-400">R$ ${l.v}</small></span>
            <button onclick="db.lazer = db.lazer.filter(x=>x.id!==${l.id});save()" class="text-rose-500 font-bold">âœ•</button>
        </div>`).join("");

    // Render CalendÃ¡rio Inteligente
    const now = new Date();
    const month = now.getMonth();
    const year = now.getFullYear();
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    
    document.getElementById('calendar-title').innerText = now.toLocaleString('pt-br', { month: 'long', year: 'numeric' }).toUpperCase();
    const grid = document.getElementById('calendar-grid');
    grid.innerHTML = "";

    for(let i=0; i<firstDay; i++) grid.innerHTML += `<div></div>`;
    for(let i=1; i<=daysInMonth; i++) {
        const fullDate = `${year}-${String(month+1).padStart(2,'0')}-${String(i).padStart(2,'0')}`;
        const hasEvent = db.agenda.some(a => a.d === fullDate);
        grid.innerHTML += `<div class="aspect-square border flex items-center justify-center text-[10px] rounded ${hasEvent?'bg-indigo-600 text-white font-bold':'bg-white text-slate-400'}">${i}</div>`;
    }

    // Render Compras, Financeiro e HistÃ³rico
    document.getElementById('comprasList').innerHTML = db.compras.map(c => `<div class="p-3 flex items-center gap-3"><input type="checkbox" onchange="ticarCompra(${c.id})" class="w-5 h-5"><span>${c.val}</span></div>`).join("");
    document.getElementById('fin-lazer').innerText = db.financeiro.lazer.toLocaleString('pt-br',{style:'currency',currency:'BRL'});
    document.getElementById('fin-casa').innerText = db.financeiro.casa.toLocaleString('pt-br',{style:'currency',currency:'BRL'});
    
    document.getElementById('h-tarefas').innerHTML = db.historico.tarefas.map(h => `<div class="text-[10px] p-2 bg-white border rounded">âœ… <b>${h.date}</b>: ${h.t} (${h.u})</div>`).reverse().join("");
    document.getElementById('h-lazer').innerHTML = db.historico.lazer.map(h => `<div class="text-[10px] p-2 bg-white border rounded">ğŸ· <b>${h.date}</b>: ${h.n} (${h.cat})</div>`).reverse().join("");
    document.getElementById('h-compras').innerHTML = db.historico.compras.map(h => `<div class="text-[10px] p-2 bg-white border rounded">ğŸ›’ <b>${h.date}</b>: ${h.val}</div>`).reverse().join("");
    document.getElementById('h-fin').innerHTML = db.historico.fin.map(h => `<div class="text-[10px] p-2 bg-white border rounded">ğŸ’° <b>${h.date}</b>: R$ ${Math.abs(h.v)} (${h.j})</div>`).reverse().join("");
}

render();
</script>
</body>
</html>
